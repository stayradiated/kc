table:
  schema: kc
  name: trade
object_relationships:
  - name: exchange
    using:
      foreign_key_constraint_on: exchange_uid
  - name: order
    using:
      foreign_key_constraint_on: order_uid
  - name: user
    using:
      foreign_key_constraint_on: user_uid
computed_fields:
  - name: fee_fx
    definition:
      function:
        schema: kc
        name: trade_fee_fx
  - name: price_fx
    definition:
      function:
        schema: kc
        name: trade_price_fx
  - name: total_value_fx
    definition:
      function:
        schema: kc
        name: trade_total_value_fx
  - name: value_fx
    definition:
      function:
        schema: kc
        name: trade_value_fx
select_permissions:
  - role: user
    permission:
      columns:
        - created_at
        - exchange_uid
        - fee
        - order_uid
        - price
        - primary_currency
        - secondary_currency
        - timestamp
        - total_value
        - trade_id
        - type
        - uid
        - updated_at
        - user_uid
        - value
        - volume
      computed_fields:
        - price_fx
        - total_value_fx
        - value_fx
        - fee_fx
      filter:
        user_uid:
          _eq: X-Hasura-User-Id
      limit: 100
      allow_aggregations: true
